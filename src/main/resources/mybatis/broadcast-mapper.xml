<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="broadcast">

	<select id="selectList" resultType="BroadcastDto">
		SELECT BROADCAST_NO, MEMBER_ID, MEMBER_PROFILE, BROADCAST_TITLE, BROADCAST_CONTENT,
			   BROADCAST_CONTENT, BROADCAST_CATEGORY, BROADCAST_FLAG, BROADCAST_STARTDATE, BROADCAST_ENDDATE
		FROM BROADCAST
		ORDER BY BROADCAST_NO DESC
	</select>
	
	<select id="selectOne" parameterType="BroadcastDto" resultType="BroadcastDto">
		SELECT BROADCAST_NO, MEMBER_ID, MEMBER_PROFILE, BROADCAST_TITLE, BROADCAST_CONTENT,
			   BROADCAST_CONTENT, BROADCAST_CATEGORY, BROADCAST_FLAG, BROADCAST_STARTDATE, BROADCAST_ENDDATE
		FROM BROADCAST
		WHERE BROADCAST_NO = #{broadcast_no}
	</select>
	
	<insert id="insert" parameterType="BroadcastDto">
		INSERT INTO BROADCAST
		VALUES(BROADCAST_NO_SEQ.NEXTVAL, #{member_id}, (SELECT PROFILE_SAVEDNAME FROM PROFILE WHERE MEMBER_ID = #{member_id}), 
		#{broadcast_title}, #{broadcast_content},#{broadcast_category}, 'Y', SYSDATE, NULL)
	</insert>
	
	<update id="update" parameterType="BroadcastDto">
		UPDATE BROADCAST
		SET BROADCAST_FLAG = 'N', BROADCAST_ENDDATE = SYSDATE WHERE MEMBER_ID = #{member_id}
	</update>
	
	<select id="select_profile" parameterType="String" resultType="BroadcastDto">
		SELECT PROFILE_SAVEDNAME AS MEMBER_PROFILE FROM PROFILE
		WHERE MEMBER_ID = #{member_id}
	</select>

</mapper>
